<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.opple.fa.assetcard.dao.AdministrationAssetDAO">

    <!-- oracle 分页头 -->
    <sql id="pagination_Head" >
        <![CDATA[select * from ( select row_.*, rownum rownum_ from ( ]]>
    </sql>
    <!-- oracle 分页尾 -->
    <sql id="pagination_Tail">
        <![CDATA[) row_ where rownum <= #{pager.pageSize}* #{pager.offset} ) where rownum_ >= #{pager.firstResult} + 1]]>
    </sql>
    <!-- count * from -->
	<sql id="count_Start_Head">
		<![CDATA[select count(*) from ( ]]>
	</sql>
	<sql id="count_Start_Tail">
		<![CDATA[) countObj ]]>
	</sql>
	<resultMap id="administrationAssetMap" type="com.opple.fa.assetcard.entity.AdministrationAsset">
        <result property="id" column="ID"/>
        <result property="serialNumber" column="SERIAL_NUMBER"/>
        <result property="managementCode" column="MANAGEMENT_CODE"/>
		<result property="isBuildingContruction" column="IS_BUILDING_CONTRUCTION"/>
		<result property="deletedFlag" column="DELETED_FLAG"/>
	</resultMap>
	<select id="getAdministrationAsset" parameterType="com.opple.fa.assetcard.entity.AdministrationAsset" resultMap="administrationAssetMap">
		select ID,
				SERIAL_NUMBER,
				MANAGEMENT_CODE,
				IS_BUILDING_CONTRUCTION
				from TB_FA_ADMINISTRATION_ASSET
				where ID=#{id}
	</select>
	<insert id="insertAdministrationAsset" keyProperty="id" useGeneratedKeys="true"  parameterType="com.opple.fa.assetcard.entity.AdministrationAsset">
	<selectKey keyProperty="id"  order="BEFORE" resultType="long">
		select seq_administration_asset.nextval as id from dual
	</selectKey>
		insert into TB_FA_ADMINISTRATION_ASSET
		(ID,
		SERIAL_NUMBER,
		MANAGEMENT_CODE,
		IS_BUILDING_CONTRUCTION
		)
		values
		(#{id},
		 #{serialNumber},
		 #{managementCode},
		 #{isBuildingContruction}
		)
	</insert>
	<update id="updateAdministrationAsset" parameterType="com.opple.fa.assetcard.entity.AdministrationAsset">
	update TB_FA_ADMINISTRATION_ASSET
		<trim prefix="SET" suffixOverrides=",">
            SERIAL_NUMBER=#{serialNumber},
		<if test="null != managementCode and '' != managementCode">
            MANAGEMENT_CODE=#{managementCode},
        </if>
		</trim>
		where ID=#{id}
	</update>
	<update id="updateAdministrationAsset1" parameterType="com.opple.fa.assetcard.entity.AdministrationAsset">
		update TB_FA_ADMINISTRATION_ASSET
		set
				SERIAL_NUMBER=#{serialNumber}
			<if test="null != managementCode and '' != managementCode">
				,MANAGEMENT_CODE=#{managementCode}
			</if>

		where ID=#{id}
	</update>

	<update id="updateAdministrationAsset2" parameterType="com.opple.fa.assetcard.entity.AdministrationAsset">
		update TB_FA_ADMINISTRATION_ASSET
		SET SERIAL_NUMBER=#{serialNumber},
		MANAGEMENT_CODE=#{managementCode}
		where ID=#{id}
	</update>
	<update id="deleteAdministrationAsset">
		update  TB_FA_ADMINISTRATION_ASSET
		set deleted_flag='1'
		where id=#{id}
	</update>
	<update id="updateLeadingAdministration" parameterType="com.opple.fa.assetcard.entity.AdministrationAsset">
	update TB_FA_ADMINISTRATION_ASSET set
		SERIAL_NUMBER=#{serialNumber},
		MANAGEMENT_CODE=#{managementCode},
		IS_BUILDING_CONTRUCTION=#{isBuildingContruction}
		where ID=#{id}
	</update>
</mapper>

