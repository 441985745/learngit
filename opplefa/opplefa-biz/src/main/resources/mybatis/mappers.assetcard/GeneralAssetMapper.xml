<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.opple.fa.assetcard.dao.GeneralAssetDAO">

	<!-- oracle 分页头 -->
	<sql id="pagination_Head">
        <![CDATA[select * from ( select row_.*, rownum rownum_ from ( ]]>
	</sql>
	<!-- oracle 分页尾 -->
	<sql id="pagination_Tail">
        <![CDATA[) row_ where rownum <= #{pager.pageSize}* #{pager.offset} ) where rownum_ >= #{pager.firstResult} + 1]]>
	</sql>
	<!-- count * from -->
	<sql id="count_Start_Head">
		<![CDATA[select count(*) from ( ]]>
	</sql>
	<sql id="count_Start_Tail">
		<![CDATA[) countObj ]]>
	</sql>
	<resultMap id="generalAssetResultMap" type="com.opple.fa.assetcard.entity.GeneralAsset">
		<result property="id" column="ID" />
		<result property="createBy" column="CREATE_BY" />
		<result property="createDate" column="CREATE_DATE" />
		<result property="updateBy" column="UPDATE_BY" />
		<result property="updateDate" column="UPDATE_DATE" />
		<result property="assetCode" column="ASSET_CODE" />
		<result property="oldAssetCode" column="OLD_ASSET_CODE" />
		<result property="purchaseOrderCode" column="PURCHASE_ORDER_CODE" />
		<result property="systeManagementCode" column="SYSTE_MANAGEMENT_CODE" />
		<result property="assetType" column="ASSET_TYPE" />
		<result property="assetName" column="ASSET_NAME" />
		<result property="putUnderManageCode" column="PUT_UNDER_MANAGE_CODE" />
		<result property="isExpenseAssets" column="IS_EXPENSE_ASSETS" />
		<result property="assetPerson" column="ASSET_PERSON" />
		<result property="specificationModel" column="SPECIFICATION_MODEL" />
		<result property="persentDepartment" column="PERSENT_DEPARTMENT" />
		<result property="companyName" column="COMPANY_NAME" />
		<result property="officeLocation" column="OFFICE_LOCATION" />
		<result property="isDraft" column="IS_DRAFT" />
		<result property="useState" column="USE_STATE" />
		<result property="assetState" column="ASSET_STATE" />
		<result property="approveState" column="APPROVE_STATE" />
		<result property="assetOriginalValue" column="ASSET_ORIGINAL_VALUE" />
		<result property="assetNetValue" column="ASSET_NET_VALUE" />

		<result property="persentStorageLocation" column="PERSENT_STORAGE_LOCATION" />
		<result property="assetDetailId" column="ASSET_DETAIL_ID" />
		<result property="deletedFlag" column="DELETED_FLAG" />
		<result property="periodOfDepreciation" column="PERIOD_OF_DEPRECIATION" />
		<result property="supplierName" column="SUPPLIER_NAME" />
		<result property="supplierCode" column="SUPPLIER_CODE" />
		<result property="manufacturer" column="MANUFACTURER" />
		<result property="usePeople" column="USE_PEOPLE" />
		<result property="useDepartment" column="USE_DEPARTMENT" />
		<result property="location" column="LOCATION" />
		<result property="remark" column="REMARK" />
		<result property="serialNumber" column="SERIAL_NUMBER" />
		<result property="isUpdateSap" column="IS_UPDATE_SAP" />
		<result property="purchaseId" column="PURCHASE_ID" />
		<result property="checkAcceptId" column="CHECK_ACCEPT_ID" />
		<result property="costCenterCode" column="COST_CENTER_CODE" />
		<result property="companyCode" column="COMPANY_CODE" />
		<result property="differentiatePurchase" column="DIFFERENTIATE_PURCHASE" />
		<result property="dateOfAcceptance" column="DATE_OF_ACCEPTANCE" />
		<result property="warrantyPeriod" column="WARRANTY_PERIOD" />
		<result property="expirationDate" column="EXPIRATION_DATE" />

		<result property="platform" column="PLATFORM" />
		<result property="supplierLinkman" column="SUPPLIER_LINKMAN" />
		<result property="supplierPhone" column="SUPPLIER_PHONE" />
		<result property="document" column="DOCUMENT" />
		<result property="demandId" column="DEMAND_ID" />
		<result property="applyId" column="APPLY_ID" />

		<result property="dateOfAcceptance" column="DATE_OF_ACCEPTANCE" />
		<result property="warrantyPeriod" column="WARRANTY_PERIOD" />
		<result property="expirationDate" column="EXPIRATION_DATE" />
		<result property="purchaseArrivalDate" column="PURCHASE_ARRIVAL_DATE" />
		<result property="actualDateAcceptance" column="ACTUAL_DATE_ACCEPTANCE" />
		<result property="oldHomeCompany" column="OLD_HOME_COMPANY" />
		<result property="selectAccessories" column="SELECT_ACCESSORIES" />
		<result property="assetClassification" column="ASSET_CLASSIFICATION" />
		<result property="postingDate" column="POSTING_DATE" />
		<result property="monthCountingDepreciation" column="MONTH_COUNTING_DEPRECIATION" />
		<result property="currentYearDepreciation" column="CURRENT_YEAR_DEPRECIATION" />
		<result property="salvageValue" column="SALVAGE_VALUE" />
		<result property="depreciationStartDate" column="DEPRECIATION_START_DATE" />
		<result property="acceptanceCycle" column="ACCEPTANCE_CYCLE" />
		<result property="remarkOne" column="REMARK_ONE" />
		<result property="remarkTwo" column="REMARK_TWO" />
		<result property="remarkThree" column="REMARK_THREE" />

		<result property="addDepreciation" column="ADD_DEPRECIATION" />
		<result property="assetPersonCode" column="ASSET_PERSON_CODE" />

		<result property="useDepartmentCode" column="USE_DEPARTMENT_CODE" />
		<result property="unit" column="UNIT" />
		<result property="assetClassificationName" column="ASSET_CLASSIFICATION_NAME" />
		<result property="isAllocationOccupancy" column="IS_ALLOCATION_OCCUPANCY" />
		<result property="isDiscardOccupancy" column="IS_DISCARD_OCCUPANCY" />
		<result property="isAssembleOccupancy" column="IS_ASSEMBLE_OCCUPANCY"/>
		<result property="unitCode" column="UNIT_CODE" />
		
		
		
		<result property="administrationAsset.serialNumber" column="serialNumberXZ" />
		<result property="administrationAsset.managementCode" column="managementCodeXZ" />
		<result property="administrationAsset.isBuildingContruction" column="isBuildingContructionXZ" />
		
		<result property="computerAsset.serialNumber" column="serialNumberDetailIT"/>
		<result property="computerAsset.putUnderManageCode" column="putUnderManageCodeIT"/>
		<result property="computerAsset.cpu" column="cpuIT"/>
		<result property="computerAsset.internalMemory" column="internalMemoryIT"/>
		<result property="computerAsset.hardpan" column="hardpanIT"/>
		<result property="computerAsset.ipAddress" column="ipAddressIT"/>
		<result property="computerAsset.joinDomain" column="joinDomainIT"/>
		<result property="computerAsset.operatingSystem" column="operatingSystemIT"/>
		<result property="computerAsset.utilitySystem" column="utilitySystemIT"/>
		<result property="computerAsset.description" column="descriptionIT"/>
		<result property="computerAsset.dataBase" column="dataBaseIT"/>
		
		
		<result property="measuringInstruments.facrotyNumber" column="facrotyNumberJL"/>
		<result property="measuringInstruments.managementCode" column="managementCodeJL"/>
		<result property="measuringInstruments.manufactureFactory" column="manufactureFactoryJL"/>
		<result property="measuringInstruments.managementLevel" column="managementLevelJL"/>
		<result property="measuringInstruments.accuracyClass" column="accuracyClassJL"/>
		<result property="measuringInstruments.verificationCycle" column="verificationCycleJL"/>
		<result property="measuringInstruments.calibrationDate" column="calibrationDateJL"/>
		<result property="measuringInstruments.nextCalibrationDate" column="nextCalibrationDateJL"/>
		<result property="measuringInstruments.calibrationUnit" column="calibrationUnitJL"/>
		<result property="measuringInstruments.isThirdReport" column="isThirdReportJL"/>
		
		
		
		<result property="machineryEquipment.machineCode" column="machineCodeJX"/>
		<result property="machineryEquipment.putUnderManageCode" column="putUnderManageCodeJX"/>
		<result property="machineryEquipment.shopType" column="shopTypeJX"/>
	</resultMap>

	<sql id="tb_Fa_General_Asset">
		SELECT tb_fa_general_asset_.ID,
		tb_fa_general_asset_.CREATE_BY,
		tb_fa_general_asset_.CREATE_DATE,
		tb_fa_general_asset_.UPDATE_BY,
		tb_fa_general_asset_.UPDATE_DATE,
		tb_fa_general_asset_.ASSET_CODE,
		tb_fa_general_asset_.OLD_ASSET_CODE,
		tb_fa_general_asset_.PURCHASE_ORDER_CODE,
		tb_fa_general_asset_.SYSTE_MANAGEMENT_CODE,
		tb_fa_general_asset_.ASSET_TYPE,
		tb_fa_general_asset_.ASSET_NAME,
		tb_fa_general_asset_.PUT_UNDER_MANAGE_CODE,
		tb_fa_general_asset_.IS_EXPENSE_ASSETS,
		tb_fa_general_asset_.ASSET_PERSON,
		tb_fa_general_asset_.SPECIFICATION_MODEL,
		tb_fa_general_asset_.PERSENT_DEPARTMENT,
		tb_fa_general_asset_.COMPANY_NAME,
		tb_fa_general_asset_.OFFICE_LOCATION,
		tb_fa_general_asset_.IS_DRAFT,
		tb_fa_general_asset_.USE_STATE,
		tb_fa_general_asset_.ASSET_STATE,
		tb_fa_general_asset_.APPROVE_STATE,
		tb_fa_general_asset_.ASSET_ORIGINAL_VALUE,
		tb_fa_general_asset_.ASSET_NET_VALUE,
		tb_fa_general_asset_.POSTING_DATE,
		tb_fa_general_asset_.PERSENT_STORAGE_LOCATION,
		tb_fa_general_asset_.ASSET_DETAIL_ID,
		tb_fa_general_asset_.DELETED_FLAG,
		tb_fa_general_asset_.PERIOD_OF_DEPRECIATION,
		tb_fa_general_asset_.SUPPLIER_NAME,
		tb_fa_general_asset_.REMARK,
		tb_fa_general_asset_.SERIAL_NUMBER,
		tb_fa_general_asset_.IS_UPDATE_SAP,
		tb_fa_general_asset_.PURCHASE_ID,
		tb_fa_general_asset_.CHECK_ACCEPT_ID,
		tb_fa_general_asset_.COST_CENTER_CODE,
		tb_fa_general_asset_.COMPANY_CODE,
		tb_fa_general_asset_.SUPPLIER_CODE,
		tb_fa_general_asset_.DATE_OF_ACCEPTANCE,
		tb_fa_general_asset_.WARRANTY_PERIOD,
		tb_fa_general_asset_.EXPIRATION_DATE,

		tb_fa_general_asset_.PLATFORM,
		tb_fa_general_asset_.SUPPLIER_LINKMAN,
		tb_fa_general_asset_.SUPPLIER_PHONE,
		tb_fa_general_asset_.LOCATION,
		tb_fa_general_asset_.DOCUMENT,
		tb_fa_general_asset_.PURCHASE_ARRIVAL_DATE,
		tb_fa_general_asset_.ACTUAL_DATE_ACCEPTANCE,
		tb_fa_general_asset_.DEMAND_ID,
		tb_fa_general_asset_.APPLY_ID,
		tb_fa_general_asset_.SELECT_ACCESSORIES,
		tb_fa_general_asset_.OLD_HOME_COMPANY,
		tb_fa_general_asset_.ASSET_CLASSIFICATION,

		tb_fa_general_asset_.MONTH_COUNTING_DEPRECIATION,
		tb_fa_general_asset_.CURRENT_YEAR_DEPRECIATION,

		tb_fa_general_asset_.SALVAGE_VALUE,
		tb_fa_general_asset_.DEPRECIATION_START_DATE,
		tb_fa_general_asset_.ACCEPTANCE_CYCLE,
		tb_fa_general_asset_.REMARK_ONE,
		tb_fa_general_asset_.REMARK_TWO,
		tb_fa_general_asset_.REMARK_THREE,
		tb_fa_general_asset_.ADD_DEPRECIATION,
		tb_fa_general_asset_.ASSET_PERSON_CODE,
		tb_fa_general_asset_.USE_DEPARTMENT_CODE,
		tb_fa_general_asset_.UNIT,
		tb_fa_general_asset_.UNIT_CODE,
		tb_fa_general_asset_.ASSET_CLASSIFICATION_NAME,
		tb_fa_general_asset_.IS_ALLOCATION_OCCUPANCY,
		tb_fa_general_asset_.IS_ASSEMBLE_OCCUPANCY
		FROM TB_FA_GENERAL_ASSET tb_fa_general_asset_
	</sql>

	<select id="searchGeneralAssetInfo" resultMap="generalAssetResultMap">
		SELECT *
		FROM TB_FA_GENERAL_ASSET tb_fa_general_asset_
		where tb_fa_general_asset_.id=#{id} and
		tb_fa_general_asset_.DELETED_FLAG='0'
	</select>
	<select id="getGeneralAsset" resultMap="generalAssetResultMap">
		SELECT *
		FROM TB_FA_GENERAL_ASSET where ID=#{id} and DELETED_FLAG='0'
	</select>
	<update id="updateGeneralAssetInfo" parameterType="com.opple.fa.allocation.entity.AssetAllocation">
		update
		TB_FA_GENERAL_ASSET SET
		ASSET_PERSON=#{postAllocationPeople},
		COMPANY_NAME=#{postAllocationCompany},
		PERSENT_STORAGE_LOCATION=#{postAllocationStoragePlace},

		PERSENT_DEPARTMENT=#{postAllocationDepartment},
		where tb_fa_general_asset_.id=#{id}

	</update>
	<select id="searchAssetCardInfo" parameterType="com.opple.fa.assetcard.entity.GeneralAsset"
		resultMap="generalAssetResultMap">
		SELECT DISTINCT tb_fa_general_asset_.*
		FROM TB_FA_GENERAL_ASSET
		tb_fa_general_asset_

		LEFT JOIN T_SAP_COSTCENTER TC
		ON tb_fa_general_asset_.COST_CENTER_CODE = TC.CCOSTCENTERCODE
		WHERE 1=1
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets != ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS=
			#{generalAsset.isExpenseAssets}
		</if>

		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND tb_fa_general_asset_.ASSET_TYPE=#{generalAsset.assetType}

		</if>
		<if
			test="generalAsset.companyName != null and generalAsset.companyName != ''">
			AND tb_fa_general_asset_.COMPANY_NAME=
			#{generalAsset.companyName}
		</if>
	
		<if
			test="generalAsset.costCenterCode != null and generalAsset.costCenterCode != ''">
			AND tb_fa_general_asset_.COST_CENTER_CODE
			=#{generalAsset.costCenterCode}
		</if>
		<!-- <if
			test="generalAsset.listAttchConfig!=null and generalAsset.listAttchConfig.size()>0">
			<foreach collection="generalAsset.listAttchConfig" index="index"
				item="item" open="or (" separator="or" close=")">
				(tb_fa_general_asset_.ASSET_TYPE=#{item.assetType} and
				tb_fa_general_asset_.COST_CENTER_CODE=#{item.attachDepartManagerCode})
			</foreach>
		</if> -->
		<if
			test="generalAsset.officeLocation != null and generalAsset.officeLocation != ''">
			AND tb_fa_general_asset_.OFFICE_LOCATION
			=#{generalAsset.officeLocation}
		</if>
		<!-- AND (
		tb_fa_general_asset_.ASSET_PERSON_CODE = #{generalAsset.loginUseCode} OR
		tb_fa_general_asset_.ASSET_PERSON_CODE IN (SELECT CAUTHORIZERCODE FROM
		T_APPROVALEMPOWER WHERE CUSERCODE = #{generalAsset.loginUseCode})
		) -->
		
		AND (
		tb_fa_general_asset_.ASSET_PERSON_CODE = #{generalAsset.loginUseCode} OR
		tb_fa_general_asset_.ASSET_PERSON_CODE IN (SELECT CAUTHORIZERCODE FROM
		T_APPROVALEMPOWER WHERE CUSERCODE = #{generalAsset.loginUseCode} )
		or (tb_fa_general_asset_.Cost_Center_Code, tb_fa_general_asset_.Company_Code, tb_fa_general_asset_.ASSET_TYPE) in
		       (SELECT C.COSTCENTER_CODE,
               C.COMPANY_CODE,
               CASE
                 WHEN C.ASSET_TYPE = 'IT资产' THEN
                  '0'
                 WHEN C.ASSET_TYPE = '行政资产' THEN
                  '1'
                 WHEN C.ASSET_TYPE = '计量器具' THEN
                  '2'
                 WHEN C.ASSET_TYPE = '机器设备' THEN
                  '3'
               END ASSET_TYPE
          FROM TB_FA_ATTACH_CONFIG C
         WHERE C.ATTACH_DEPART_ADMIN_CODE = #{generalAsset.loginUseCode})
		)
		
		AND tb_fa_general_asset_.IS_ALLOCATION_OCCUPANCY='0'
		AND
		tb_fa_general_asset_.IS_DISCARD_OCCUPANCY = '0'
		AND
		tb_fa_general_asset_.DELETED_FLAG = '0'
		and tb_fa_general_asset_.ASSET_STATE='1'


		order by tb_fa_general_asset_.ID desc
	</select>
	<select id="searchAssetCardInfoForBursar" parameterType="com.opple.fa.assetcard.entity.GeneralAsset"
		resultMap="generalAssetResultMap">
		SELECT DISTINCT tb_fa_general_asset_.*
		FROM TB_FA_GENERAL_ASSET
		tb_fa_general_asset_

		LEFT JOIN T_SAP_COSTCENTER TC
		ON tb_fa_general_asset_.COST_CENTER_CODE = TC.CCOSTCENTERCODE
		WHERE 1=1
		<if test="generalAsset.assetName != null and generalAsset.assetName != ''">
			AND tb_fa_general_asset_.ASSET_NAME LIKE '%' ||
			#{generalAsset.assetName} || '%'
		</if>
		<if test="generalAsset.assetCode != null and generalAsset.assetCode != ''">
			AND tb_fa_general_asset_.ASSET_CODE LIKE '%' ||
			#{generalAsset.assetCode} || '%'
		</if>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson != ''">
			AND tb_fa_general_asset_.ASSET_PERSON LIKE '%' ||
			#{generalAsset.assetPerson} || '%'
		</if>
		<if
			test="generalAsset.specificationModel != null and generalAsset.specificationModel != ''">
			AND tb_fa_general_asset_.SPECIFICATION_MODEL LIKE '%' ||
			#{generalAsset.specificationModel} || '%'
		</if>
		<if
			test="generalAsset.persentDepartment != null and generalAsset.persentDepartment != ''">
			AND tb_fa_general_asset_.PERSENT_DEPARTMENT LIKE '%' ||
			#{generalAsset.persentDepartment} || '%'
		</if>
		<if
			test="generalAsset.companyName != null and generalAsset.companyName != ''">
			AND (tb_fa_general_asset_.COMPANY_NAME LIKE '%' ||
			#{generalAsset.companyName} || '%' or tb_fa_general_asset_.COMPANY_CODE LIKE '%' ||
			#{generalAsset.companyName} || '%')
		</if>

		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets != ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS
			=#{generalAsset.isExpenseAssets}
		</if>
		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND tb_fa_general_asset_.ASSET_TYPE =
			#{generalAsset.assetType}
		</if>
		<if
			test="generalAsset.costCenterCode != null and generalAsset.costCenterCode != ''">
			AND tb_fa_general_asset_.COST_CENTER_CODE
			LIKE '%' ||
			#{generalAsset.costCenterCode} || '%'
		</if>
		<if
			test="generalAsset.officeLocation != null and generalAsset.officeLocation != ''">
			AND tb_fa_general_asset_.OFFICE_LOCATION
			=#{generalAsset.officeLocation}
		</if>
		AND tb_fa_general_asset_.IS_ALLOCATION_OCCUPANCY='0'
		AND
		tb_fa_general_asset_.IS_DISCARD_OCCUPANCY = '0'
		AND
		tb_fa_general_asset_.DELETED_FLAG = '0'
		and tb_fa_general_asset_.ASSET_STATE='1'

		order by tb_fa_general_asset_.ID desc
	</select>

	<select id="searchGeneralAsset" parameterType="com.opple.fa.assetcard.entity.GeneralAsset"
		resultMap="generalAssetResultMap">
		SELECT tb_fa_general_asset_.*
		FROM TB_FA_GENERAL_ASSET
		tb_fa_general_asset_

		<!-- LEFT JOIN T_SAP_COSTCENTER TC
		ON tb_fa_general_asset_.COST_CENTER_CODE = TC.CCOSTCENTERCODE -->

		WHERE 1=1
		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND tb_fa_general_asset_.ASSET_TYPE =
			#{generalAsset.assetType}
		</if>
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets != ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS
			=#{generalAsset.isExpenseAssets}
		</if>
		<if test="generalAsset.assetName != null and generalAsset.assetName != ''">
			AND tb_fa_general_asset_.ASSET_NAME LIKE '%' ||
			#{generalAsset.assetName} || '%'
		</if>
		<if test="generalAsset.assetCode != null and generalAsset.assetCode != ''">
			AND tb_fa_general_asset_.ASSET_CODE LIKE '%' ||
			#{generalAsset.assetCode} || '%'
		</if>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson != ''">
			AND (tb_fa_general_asset_.ASSET_PERSON LIKE '%' ||
			#{generalAsset.assetPerson} || '%' or tb_fa_general_asset_.ASSET_PERSON_CODE LIKE '%' ||
			#{generalAsset.assetPerson} || '%')
		</if>
		<if
			test="generalAsset.specificationModel != null and generalAsset.specificationModel != ''">
			AND tb_fa_general_asset_.SPECIFICATION_MODEL LIKE '%' ||
			#{generalAsset.specificationModel} || '%'
		</if>
		<if
			test="generalAsset.companyName != null and generalAsset.companyName != ''">
			AND (tb_fa_general_asset_.COMPANY_NAME LIKE '%' ||
			#{generalAsset.companyName} || '%' or tb_fa_general_asset_.COMPANY_CODE LIKE '%' ||
			#{generalAsset.companyName} || '%')
		</if>

	
		<if
			test="generalAsset.costCenterCode != null and generalAsset.costCenterCode != ''">
			AND tb_fa_general_asset_.COST_CENTER_CODE
			LIKE '%' ||
			#{generalAsset.costCenterCode} || '%'
		</if>
		<if
			test="generalAsset.isAssembleOccupancy != null and generalAsset.isAssembleOccupancy != ''">
			AND tb_fa_general_asset_.IS_ASSEMBLE_OCCUPANCY=#{generalAsset.isAssembleOccupancy} 
		</if>
		<!--<if
			test="generalAsset.listAttchConfig!=null and generalAsset.listAttchConfig.size()>0">
			 <foreach collection="generalAsset.listAttchConfig" index="index"
				item="item" open="and (" separator="or" close=")">
				(tb_fa_general_asset_.ASSET_TYPE=#{item.assetType} and
				tb_fa_general_asset_.COST_CENTER_CODE=#{item.attachDepartManagerCode})
			</foreach> 
		</if>-->
			
		<if
			test="generalAsset.officeLocation != null and generalAsset.officeLocation != ''">
			AND tb_fa_general_asset_.OFFICE_LOCATION
			=#{generalAsset.officeLocation}
		</if>
		
		<!-- AND (
		tb_fa_general_asset_.ASSET_PERSON_CODE = #{generalAsset.loginUseCode} OR
		tb_fa_general_asset_.ASSET_PERSON_CODE IN (SELECT CAUTHORIZERCODE FROM
		T_APPROVALEMPOWER WHERE CUSERCODE = #{generalAsset.loginUseCode} )
		or (tb_fa_general_asset_.Cost_Center_Code, tb_fa_general_asset_.Company_Code, tb_fa_general_asset_.ASSET_TYPE) in
		       (SELECT C.COSTCENTER_CODE,
               C.COMPANY_CODE,
               CASE
                 WHEN C.ASSET_TYPE = 'IT资产' THEN
                  '0'
                 WHEN C.ASSET_TYPE = '行政资产' THEN
                  '1'
                 WHEN C.ASSET_TYPE = '计量器具' THEN
                  '2'
                 WHEN C.ASSET_TYPE = '机器设备' THEN
                  '3'
               END ASSET_TYPE
          FROM TB_FA_ATTACH_CONFIG C
         WHERE C.ATTACH_DEPART_ADMIN_CODE = #{generalAsset.loginUseCode})
		)
		 -->
		AND tb_fa_general_asset_.IS_ALLOCATION_OCCUPANCY='0'
		AND
		tb_fa_general_asset_.IS_DISCARD_OCCUPANCY = '0'
		AND
		tb_fa_general_asset_.DELETED_FLAG = '0'
		and tb_fa_general_asset_.ASSET_STATE='1'

		order by tb_fa_general_asset_.ID desc

	</select>

	<select id="searchDetails" resultMap="generalAssetResultMap">
		SELECT tb_fa_general_asset_.ID,
		tb_fa_general_asset_.CREATE_BY,
		tb_fa_general_asset_.CREATE_DATE,
		tb_fa_general_asset_.UPDATE_BY,
		tb_fa_general_asset_.UPDATE_DATE,
		tb_fa_general_asset_.ASSET_CODE,
		tb_fa_general_asset_.OLD_ASSET_CODE,
		tb_fa_general_asset_.PURCHASE_ORDER_CODE,
		tb_fa_general_asset_.SYSTE_MANAGEMENT_CODE,
		tb_fa_general_asset_.ASSET_TYPE,
		tb_fa_general_asset_.ASSET_NAME,
		tb_fa_general_asset_.PUT_UNDER_MANAGE_CODE,
		tb_fa_general_asset_.IS_EXPENSE_ASSETS,
		tb_fa_general_asset_.ASSET_PERSON,
		tb_fa_general_asset_.SPECIFICATION_MODEL,
		DC.CCOSTCENTERNAME AS PERSENT_DEPARTMENT,
		DC.CDEPCODE AS USE_DEPARTMENT_CODE,
		DC.CCOSTCENTERNAME AS USE_DEPARTMENT,
		tb_fa_general_asset_.COMPANY_NAME,
		tb_fa_general_asset_.OFFICE_LOCATION,
		tb_fa_general_asset_.IS_DRAFT,
		tb_fa_general_asset_.USE_STATE,
		tb_fa_general_asset_.ASSET_STATE,
		tb_fa_general_asset_.APPROVE_STATE,
		tb_fa_general_asset_.ASSET_ORIGINAL_VALUE,
		tb_fa_general_asset_.ASSET_NET_VALUE,
		tb_fa_general_asset_.POSTING_DATE,
		tb_fa_general_asset_.PERSENT_STORAGE_LOCATION,
		tb_fa_general_asset_.ASSET_DETAIL_ID,
		tb_fa_general_asset_.DELETED_FLAG,
		tb_fa_general_asset_.PERIOD_OF_DEPRECIATION,
		tb_fa_general_asset_.SUPPLIER_NAME,
		tb_fa_general_asset_.REMARK,
		tb_fa_general_asset_.SERIAL_NUMBER,
		tb_fa_general_asset_.IS_UPDATE_SAP,
		tb_fa_general_asset_.PURCHASE_ID,
		tb_fa_general_asset_.CHECK_ACCEPT_ID,
		tb_fa_general_asset_.COST_CENTER_CODE,
		tb_fa_general_asset_.COMPANY_CODE,
		tb_fa_general_asset_.SUPPLIER_CODE,
		tb_fa_general_asset_.DATE_OF_ACCEPTANCE,
		tb_fa_general_asset_.WARRANTY_PERIOD,
		tb_fa_general_asset_.EXPIRATION_DATE,

		tb_fa_general_asset_.PLATFORM,
		tb_fa_general_asset_.SUPPLIER_LINKMAN,
		tb_fa_general_asset_.SUPPLIER_PHONE,
		tb_fa_general_asset_.LOCATION,
		tb_fa_general_asset_.DOCUMENT,
		tb_fa_general_asset_.PURCHASE_ARRIVAL_DATE,
		tb_fa_general_asset_.ACTUAL_DATE_ACCEPTANCE,
		tb_fa_general_asset_.DEMAND_ID,
		tb_fa_general_asset_.APPLY_ID,
		tb_fa_general_asset_.SELECT_ACCESSORIES,
		tb_fa_general_asset_.OLD_HOME_COMPANY,
		tb_fa_general_asset_.ASSET_CLASSIFICATION,

		tb_fa_general_asset_.MONTH_COUNTING_DEPRECIATION,
		tb_fa_general_asset_.CURRENT_YEAR_DEPRECIATION,

		tb_fa_general_asset_.SALVAGE_VALUE,
		tb_fa_general_asset_.DEPRECIATION_START_DATE,
		tb_fa_general_asset_.ACCEPTANCE_CYCLE,
		tb_fa_general_asset_.REMARK_ONE,
		tb_fa_general_asset_.REMARK_TWO,
		tb_fa_general_asset_.REMARK_THREE,
		tb_fa_general_asset_.ADD_DEPRECIATION,
		tb_fa_general_asset_.ASSET_PERSON_CODE,
		tb_fa_general_asset_.UNIT,
		tb_fa_general_asset_.UNIT_CODE,
		tb_fa_general_asset_.ASSET_CLASSIFICATION_NAME,
		tb_fa_general_asset_.IS_ASSEMBLE_OCCUPANCY

		FROM TB_FA_GENERAL_ASSET tb_fa_general_asset_
		LEFT JOIN TB_FA_DEPCOSTCENTER DC ON
		LTRIM(tb_fa_general_asset_.COST_CENTER_CODE,'0') =
		LTRIM(DC.CCOSTCENTERCODE,'0')

		<if test="generalAsset.id != null and generalAsset.id != ''">
			WHERE tb_fa_general_asset_.id= #{generalAsset.id}
		
		</if>
		AND ROWNUM=1
	</select>
	<select id="searchTbFaGeneralAsset" resultMap="generalAssetResultMap">
		<include refid="pagination_Head"></include>
		<include refid="tb_Fa_General_Asset"></include>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson !=''">
			WHERE tb_fa_general_asset_.ASSET_PERSON =
			#{generalAsset.assetPerson}
			AND tb_fa_general_asset_.DELETED_FLAG =
			'0'
		</if>
		<include refid="pagination_Tail"></include>
	</select>

	<select id="searchTbFaGeneralAssetCount" resultType="long">
		<include refid="count_Start_Head"></include>
		<include refid="tb_Fa_General_Asset"></include>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson !=''">
			WHERE tb_fa_general_asset_.ASSET_PERSON =
			#{generalAsset.assetPerson}
			AND tb_fa_general_asset_.DELETED_FLAG =
			'0'
		</if>
		<include refid="count_Start_Tail"></include>
	</select>

	<sql id="search_general_asset">

		SELECT ID,
		CREATE_BY,
		CREATE_DATE,
		UPDATE_BY,
		UPDATE_DATE,
		ASSET_CODE,
		OLD_ASSET_CODE,
		PURCHASE_ORDER_CODE,
		SYSTE_MANAGEMENT_CODE,
		ASSET_TYPE,
		ASSET_NAME,
		PUT_UNDER_MANAGE_CODE,
		IS_EXPENSE_ASSETS,
		ASSET_PERSON,
		SPECIFICATION_MODEL,
		PERSENT_DEPARTMENT,
		COMPANY_NAME,
		OFFICE_LOCATION,
		IS_DRAFT,
		USE_STATE,
		ASSET_STATE,
		APPROVE_STATE,
		ASSET_ORIGINAL_VALUE,
		ASSET_NET_VALUE,
		POSTING_DATE,
		PERSENT_STORAGE_LOCATION,
		ASSET_DETAIL_ID,
		DELETED_FLAG,
		PERIOD_OF_DEPRECIATION,
		SUPPLIER_NAME,
		MANUFACTURER,
		USE_PEOPLE,
		USE_DEPARTMENT,
		LOCATION,
		REMARK,
		SERIAL_NUMBER,
		IS_UPDATE_SAP,
		PURCHASE_ID,
		CHECK_ACCEPT_ID,
		COST_CENTER_CODE,
		COMPANY_CODE,
		SUPPLIER_CODE,
		DIFFERENTIATE_PURCHASE,

		PLATFORM,
		SUPPLIER_LINKMAN,
		SUPPLIER_PHONE,
		DOCUMENT,
		DATE_OF_ACCEPTANCE,
		WARRANTY_PERIOD,
		EXPIRATION_DATE,
		PURCHASE_ARRIVAL_DATE,
		ACTUAL_DATE_ACCEPTANCE,
		OLD_HOME_COMPANY,
		SELECT_ACCESSORIES,
		ASSET_CLASSIFICATION,

		MONTH_COUNTING_DEPRECIATION,
		CURRENT_YEAR_DEPRECIATION,

		SALVAGE_VALUE,
		DEPRECIATION_START_DATE,
		ACCEPTANCE_CYCLE,
		REMARK_ONE,
		REMARK_TWO,
		REMARK_THREE,
		ADD_DEPRECIATION,
		ASSET_PERSON_CODE,
		USE_DEPARTMENT_CODE,
		UNIT,
		UNIT_CODE,
		ASSET_CLASSIFICATION_NAME,
		IS_ALLOCATION_OCCUPANCY,
		IS_ASSEMBLE_OCCUPANCY
		FROM TB_FA_GENERAL_ASSET

		WHERE
		1=1 AND DELETED_FLAG='0'
		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND ASSET_TYPE=#{generalAsset.assetType}

		</if>
		<if test="generalAsset.isAllocationOccupancy != null and generalAsset.isAllocationOccupancy !=''">
			AND IS_ALLOCATION_OCCUPANCY=#{generalAsset.isAllocationOccupancy}
		</if>
		<if
			test="generalAsset.assetState != null and generalAsset.assetState != ''">
			AND ASSET_STATE=#{generalAsset.assetState}

		</if>
		<if
			test="generalAsset.systeManagementCode != null and generalAsset.systeManagementCode != ''">
			AND SYSTE_MANAGEMENT_CODE LIKE '%' ||
			#{generalAsset.systeManagementCode} || '%'

		</if>
		<if test="generalAsset.assetCode != null and generalAsset.assetCode != ''">
			AND ASSET_CODE LIKE '%' || #{generalAsset.assetCode} || '%'
		</if>
		<if
			test="generalAsset.putUnderManageCode != null and generalAsset.putUnderManageCode != ''">
			AND PUT_UNDER_MANAGE_CODE LIKE '%' || #{generalAsset.putUnderManageCode}
			|| '%'
		</if>
		<if test="generalAsset.assetName != null and generalAsset.assetName != ''">
			AND ASSET_NAME LIKE '%' || #{generalAsset.assetName} || '%'
		</if>
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND IS_EXPENSE_ASSETS =#{generalAsset.isExpenseAssets}
		</if>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson != ''">
			AND (ASSET_PERSON LIKE '%' || #{generalAsset.assetPerson} || '%' or ASSET_PERSON_CODE LIKE '%' || #{generalAsset.assetPerson} || '%')
		</if>
		<if
			test="generalAsset.specificationModel != null and generalAsset.specificationModel != ''">
			AND SPECIFICATION_MODEL LIKE '%' || #{generalAsset.specificationModel}
			|| '%'
		</if>
		<if
			test="generalAsset.persentDepartment != null and generalAsset.persentDepartment != ''">
			AND (PERSENT_DEPARTMENT LIKE '%' || #{generalAsset.persentDepartment} ||
			'%'  or COST_CENTER_CODE LIKE '%' || #{generalAsset.persentDepartment} ||
			'%')
		</if>
		<if test="generalAsset.useState != null and generalAsset.useState != ''">
			AND USE_STATE LIKE '%' || #{generalAsset.useState} || '%'
		</if>
		<if
			test="generalAsset.officeLocation != null and generalAsset.officeLocation != ''">
			AND OFFICE_LOCATION LIKE '%' || #{generalAsset.officeLocation} || '%'
		</if>
		<if
			test="generalAsset.companyName != null and generalAsset.companyName != ''">
			AND (COMPANY_NAME LIKE '%' || #{generalAsset.companyName} || '%' or COMPANY_CODE LIKE '%' || #{generalAsset.companyName} || '%')
		</if>
		<if
			test="generalAsset.approveState!= null and generalAsset.approveState != ''">
			AND APPROVE_STATE = #{generalAsset.approveState}
		</if>
		<if test="generalAsset.isDraft!= null and generalAsset.isDraft != ''">
			AND IS_DRAFT = #{generalAsset.isDraft}
		</if>
		<if
			test="generalAsset.isUpdateSap!= null and generalAsset.isUpdateSap != ''">
			AND IS_UPDATE_SAP = #{generalAsset.isUpdateSap}
		</if>
		<if
			test="generalAsset.assetClassification!= null and generalAsset.assetClassification != ''">
			AND ASSET_CLASSIFICATION LIKE '%' || #{generalAsset.assetClassification} || '%' 
		</if>
		<if
			test="generalAsset.loginUseCode!=null and generalAsset.loginUseCode!=''">
			<!-- AND (ASSET_PERSON_CODE = #{generalAsset.loginUseCode} OR
			ASSET_PERSON_CODE IN (SELECT CAUTHORIZERCODE FROM T_APPROVALEMPOWER
			WHERE CUSERCODE = #{generalAsset.loginUseCode}) ) -->

			AND ( 
			  
				ASSET_PERSON_CODE = #{generalAsset.loginUseCode} 
				or (EXISTS(SELECT 1 FROM t_Sys_Userrole TR WHERE TR.CROLECODE=#{generalAsset.assetAdminId} 
					AND TR.CUSERCODE=#{generalAsset.loginUseCode}  AND tr.cstatus='Y'))
				OR 
				ASSET_PERSON_CODE IN (SELECT CAUTHORIZERCODE FROM
				T_APPROVALEMPOWER WHERE CUSERCODE = #{generalAsset.loginUseCode} )
				or (Cost_Center_Code, Company_Code, ASSET_TYPE) in
				       (SELECT C.COSTCENTER_CODE,
		               C.COMPANY_CODE,
		               CASE
		                 WHEN C.ASSET_TYPE = 'IT资产' THEN
		                  '0'
		                 WHEN C.ASSET_TYPE = '行政资产' THEN
		                  '1'
		                 WHEN C.ASSET_TYPE = '计量器具' THEN
		                  '2'
		                 WHEN C.ASSET_TYPE = '机器设备' THEN
		                  '3'
		               END ASSET_TYPE
		          FROM TB_FA_ATTACH_CONFIG C
		         WHERE C.ATTACH_DEPART_ADMIN_CODE = #{generalAsset.loginUseCode})
		          OR (COST_CENTER_CODE IN (select b.ccostcentercode from t_sys_datapermission a inner join tb_fa_depcostcenter b
				    on a.cbudgetdepcode = b.cdepcode where a.cusercode = #{generalAsset.loginUseCode} and exists
				 (select 1 from t_sys_userrole aa where aa.cusercode = #{generalAsset.loginUseCode}  
				 and aa.crolecode in (${generalAsset.ruleId})))) 
								) 
				
		</if>
	
		<!-- <if
			test="generalAsset.listAttchConfig!=null and generalAsset.listAttchConfig.size()>0">
			<foreach collection="generalAsset.listAttchConfig" index="index"
				item="item" open="or (" separator="or" close=")">
				(ASSET_TYPE=#{item.assetType} and
				COST_CENTER_CODE=#{item.attachDepartManagerCode})
			</foreach>
		</if> -->

		order by ID desc

	</sql>
	<select id="serchAssetCardData" resultMap="generalAssetResultMap">
		SELECT DISTINCT tb_fa_general_asset_.*
		FROM TB_FA_GENERAL_ASSET
		tb_fa_general_asset_

		LEFT JOIN T_SAP_COSTCENTER TC
		ON tb_fa_general_asset_.COST_CENTER_CODE = TC.CCOSTCENTERCODE
		where 1=1
		AND tb_fa_general_asset_.DELETED_FLAG = '0'

		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS
			=#{generalAsset.isExpenseAssets}
		</if>
		<if test="generalAsset.assetState != null and generalAsset.assetState!=''">
			AND tb_fa_general_asset_.ASSET_STATE =#{generalAsset.assetState}
		</if>
		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND tb_fa_general_asset_.ASSET_TYPE=#{generalAsset.assetType}

		</if>
		<if
			test="generalAsset.systeManagementCode != null and generalAsset.systeManagementCode != ''">
			AND tb_fa_general_asset_.SYSTE_MANAGEMENT_CODE LIKE '%' ||
			#{generalAsset.systeManagementCode} || '%'

		</if>
		<if test="generalAsset.assetCode != null and generalAsset.assetCode != ''">
			AND tb_fa_general_asset_.ASSET_CODE LIKE '%' || #{generalAsset.assetCode} || '%'
		</if>
		<if
			test="generalAsset.putUnderManageCode != null and generalAsset.putUnderManageCode != ''">
			AND tb_fa_general_asset_.PUT_UNDER_MANAGE_CODE LIKE '%' || #{generalAsset.putUnderManageCode}
			|| '%'
		</if>
		<if test="generalAsset.assetName != null and generalAsset.assetName != ''">
			AND tb_fa_general_asset_.ASSET_NAME LIKE '%' || #{generalAsset.assetName} || '%'
		</if>
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS =#{generalAsset.isExpenseAssets}
		</if>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson != ''">
			AND tb_fa_general_asset_.ASSET_PERSON LIKE '%' || #{generalAsset.assetPerson} || '%'
		</if>
		<if
			test="generalAsset.specificationModel != null and generalAsset.specificationModel != ''">
			AND tb_fa_general_asset_.SPECIFICATION_MODEL LIKE '%' || #{generalAsset.specificationModel}
			|| '%'
		</if>
		<if
			test="generalAsset.persentDepartment != null and generalAsset.persentDepartment != ''">
			AND tb_fa_general_asset_.PERSENT_DEPARTMENT LIKE '%' || #{generalAsset.persentDepartment} ||
			'%'
		</if>
		<if
			test="generalAsset.officeLocation != null and generalAsset.officeLocation != ''">
			AND tb_fa_general_asset_.OFFICE_LOCATION LIKE '%' || #{generalAsset.officeLocation} || '%'
		</if>
		AND (
		tb_fa_general_asset_.ASSET_PERSON_CODE = #{generalAsset.loginUseCode} OR
		tb_fa_general_asset_.ASSET_PERSON_CODE IN (SELECT CAUTHORIZERCODE FROM
		T_APPROVALEMPOWER WHERE CUSERCODE = #{generalAsset.loginUseCode})
		or (Cost_Center_Code, Company_Code, ASSET_TYPE) in
				       (SELECT C.COSTCENTER_CODE,
		               C.COMPANY_CODE,
		               CASE
		                 WHEN C.ASSET_TYPE = 'IT资产' THEN
		                  '0'
		                 WHEN C.ASSET_TYPE = '行政资产' THEN
		                  '1'
		                 WHEN C.ASSET_TYPE = '计量器具' THEN
		                  '2'
		                 WHEN C.ASSET_TYPE = '机器设备' THEN
		                  '3'
		               END ASSET_TYPE
		          FROM TB_FA_ATTACH_CONFIG C
		         WHERE C.ATTACH_DEPART_ADMIN_CODE = #{generalAsset.loginUseCode})		       
 		    OR (COST_CENTER_CODE IN (select b.ccostcentercode from t_sys_datapermission a inner join tb_fa_depcostcenter b
				    on a.cbudgetdepcode = b.cdepcode where a.cusercode = #{generalAsset.loginUseCode} and exists
				 (select 1 from t_sys_userrole aa where aa.cusercode = #{generalAsset.loginUseCode}  
				 and aa.crolecode in (${generalAsset.ruleId})))) 
		)
	</select>
	<select id="serchAssetCardByinsert" resultMap="generalAssetResultMap">
		select * from
		TB_FA_GENERAL_ASSET where 1=1 and DELETED_FLAG = '0'
	</select>
	<select id="serchAssetCardDateByAccounting" resultMap="generalAssetResultMap">
		SELECT tb_fa_general_asset_.*
		FROM TB_FA_GENERAL_ASSET tb_fa_general_asset_ where 1=1 AND
		
		tb_fa_general_asset_.DELETED_FLAG = '0'
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS
			=#{generalAsset.isExpenseAssets}
		</if>
		<if test="generalAsset.assetState != null and generalAsset.assetState!=''">
			AND tb_fa_general_asset_.ASSET_STATE =#{generalAsset.assetState}
		</if>
		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND tb_fa_general_asset_.ASSET_TYPE=#{generalAsset.assetType}

		</if>
		<if
			test="generalAsset.systeManagementCode != null and generalAsset.systeManagementCode != ''">
			AND tb_fa_general_asset_.SYSTE_MANAGEMENT_CODE LIKE '%' ||
			#{generalAsset.systeManagementCode} || '%'

		</if>
		<if test="generalAsset.assetCode != null and generalAsset.assetCode != ''">
			AND tb_fa_general_asset_.ASSET_CODE LIKE '%' || #{generalAsset.assetCode} || '%'
		</if>
		<if
			test="generalAsset.putUnderManageCode != null and generalAsset.putUnderManageCode != ''">
			AND tb_fa_general_asset_.PUT_UNDER_MANAGE_CODE LIKE '%' || #{generalAsset.putUnderManageCode}
			|| '%'
		</if>
		<if test="generalAsset.assetName != null and generalAsset.assetName != ''">
			AND tb_fa_general_asset_.ASSET_NAME LIKE '%' || #{generalAsset.assetName} || '%'
		</if>
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS =#{generalAsset.isExpenseAssets}
		</if>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson != ''">
			AND tb_fa_general_asset_.ASSET_PERSON LIKE '%' || #{generalAsset.assetPerson} || '%'
		</if>
		<if
			test="generalAsset.specificationModel != null and generalAsset.specificationModel != ''">
			AND tb_fa_general_asset_.SPECIFICATION_MODEL LIKE '%' || #{generalAsset.specificationModel}
			|| '%'
		</if>
		<if
			test="generalAsset.persentDepartment != null and generalAsset.persentDepartment != ''">
			AND tb_fa_general_asset_.PERSENT_DEPARTMENT LIKE '%' || #{generalAsset.persentDepartment} ||
			'%'
		</if>
		
	</select>
	<select id="serchAssetCard" resultMap="generalAssetResultMap">
		<include refid="pagination_Head" />
		<include refid="search_general_asset" />
		<include refid="pagination_Tail" />
	</select>
	<select id="serchAssetCardCount" resultType="long">
		<include refid="count_Start_Head" />
		<include refid="search_general_asset" />
		<include refid="count_Start_Tail" />
	</select>
	<select id="serchAssetCardByAccounting" resultMap="generalAssetResultMap">
		<include refid="pagination_Head" />
		select * from TB_FA_GENERAL_ASSET where 1=1
		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND ASSET_TYPE=#{generalAsset.assetType}

		</if>
		<if test="generalAsset.isAllocationOccupancy != null and generalAsset.isAllocationOccupancy !=''">
			AND IS_ALLOCATION_OCCUPANCY=#{generalAsset.isAllocationOccupancy}
		</if>
		<if
			test="generalAsset.assetState != null and generalAsset.assetState != ''">
			AND ASSET_STATE=#{generalAsset.assetState}

		</if>
		<if
			test="generalAsset.systeManagementCode != null and generalAsset.systeManagementCode != ''">
			AND SYSTE_MANAGEMENT_CODE LIKE '%' ||
			#{generalAsset.systeManagementCode} || '%'

		</if>
		<if test="generalAsset.assetCode != null and generalAsset.assetCode != ''">
			AND ASSET_CODE LIKE '%' || #{generalAsset.assetCode} || '%'
		</if>
		<if
			test="generalAsset.putUnderManageCode != null and generalAsset.putUnderManageCode != ''">
			AND PUT_UNDER_MANAGE_CODE LIKE '%' || #{generalAsset.putUnderManageCode}
			|| '%'
		</if>
		<if test="generalAsset.assetName != null and generalAsset.assetName != ''">
			AND ASSET_NAME LIKE '%' || #{generalAsset.assetName} || '%'
		</if>
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND IS_EXPENSE_ASSETS =#{generalAsset.isExpenseAssets}
		</if>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson != ''">
			AND ASSET_PERSON LIKE '%' || #{generalAsset.assetPerson} || '%'
		</if>
		<if
			test="generalAsset.specificationModel != null and generalAsset.specificationModel != ''">
			AND SPECIFICATION_MODEL LIKE '%' || #{generalAsset.specificationModel}
			|| '%'
		</if>
		<if
			test="generalAsset.persentDepartment != null and generalAsset.persentDepartment != ''">
			AND (PERSENT_DEPARTMENT LIKE '%' || #{generalAsset.persentDepartment} ||
			'%' OR COST_CENTER_CODE LIKE '%' || #{generalAsset.persentDepartment} ||
			'%')
		</if>
		<if test="generalAsset.useState != null and generalAsset.useState != ''">
			AND USE_STATE LIKE '%' || #{generalAsset.useState} || '%'
		</if>
		<if
			test="generalAsset.officeLocation != null and generalAsset.officeLocation != ''">
			AND OFFICE_LOCATION LIKE '%' || #{generalAsset.officeLocation} || '%'
		</if>
		<if
			test="generalAsset.companyName != null and generalAsset.companyName != ''">
			AND (COMPANY_NAME LIKE '%' || #{generalAsset.companyName} || '%' or COMPANY_CODE LIKE '%' || #{generalAsset.companyName} || '%')
		</if>
		<if
			test="generalAsset.approveState!= null and generalAsset.approveState != ''">
			AND APPROVE_STATE = #{generalAsset.approveState}
		</if>
		<if test="generalAsset.isDraft!= null and generalAsset.isDraft != ''">
			AND IS_DRAFT = #{generalAsset.isDraft}
		</if>
		<if
			test="generalAsset.isUpdateSap!= null and generalAsset.isUpdateSap != ''">
			AND IS_UPDATE_SAP = #{generalAsset.isUpdateSap}
		</if>
		<if
			test="generalAsset.assetClassification!= null and generalAsset.assetClassification != ''">
			AND ASSET_CLASSIFICATION LIKE '%' ||  #{generalAsset.assetClassification} || '%' 
		</if>
		and DELETED_FLAG='0' order by ID desc
		<include refid="pagination_Tail" />
	</select>
	<select id="serchAssetCardCountByAccounting" resultType="long">
		<include refid="count_Start_Head" />
		select * from TB_FA_GENERAL_ASSET where 1=1
		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND ASSET_TYPE=#{generalAsset.assetType}

		</if>
		<if
			test="generalAsset.assetState != null and generalAsset.assetState != ''">
			AND ASSET_STATE=#{generalAsset.assetState}

		</if>
		<if test="generalAsset.isAllocationOccupancy != null and generalAsset.isAllocationOccupancy !=''">
			AND IS_ALLOCATION_OCCUPANCY=#{generalAsset.isAllocationOccupancy}
		</if>
		<if
			test="generalAsset.systeManagementCode != null and generalAsset.systeManagementCode != ''">
			AND SYSTE_MANAGEMENT_CODE LIKE '%' ||
			#{generalAsset.systeManagementCode} || '%'

		</if>
		<if test="generalAsset.assetCode != null and generalAsset.assetCode != ''">
			AND ASSET_CODE LIKE '%' || #{generalAsset.assetCode} || '%'
		</if>
		<if
			test="generalAsset.putUnderManageCode != null and generalAsset.putUnderManageCode != ''">
			AND PUT_UNDER_MANAGE_CODE LIKE '%' || #{generalAsset.putUnderManageCode}
			|| '%'
		</if>
		<if test="generalAsset.assetName != null and generalAsset.assetName != ''">
			AND ASSET_NAME LIKE '%' || #{generalAsset.assetName} || '%'
		</if>
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND IS_EXPENSE_ASSETS =#{generalAsset.isExpenseAssets}
		</if>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson != ''">
			AND ASSET_PERSON LIKE '%' || #{generalAsset.assetPerson} || '%'
		</if>
		<if
			test="generalAsset.specificationModel != null and generalAsset.specificationModel != ''">
			AND SPECIFICATION_MODEL LIKE '%' || #{generalAsset.specificationModel}
			|| '%'
		</if>
		<if
			test="generalAsset.persentDepartment != null and generalAsset.persentDepartment != ''">
			AND PERSENT_DEPARTMENT LIKE '%' || #{generalAsset.persentDepartment} ||
			'%'
		</if>
		<if test="generalAsset.useState != null and generalAsset.useState != ''">
			AND USE_STATE LIKE '%' || #{generalAsset.useState} || '%'
		</if>
		<if
			test="generalAsset.officeLocation != null and generalAsset.officeLocation != ''">
			AND OFFICE_LOCATION LIKE '%' || #{generalAsset.officeLocation} || '%'
		</if>
		<if
			test="generalAsset.companyName != null and generalAsset.companyName != ''">
			AND (COMPANY_NAME LIKE '%' || #{generalAsset.companyName} || '%' or COMPANY_CODE LIKE '%' || #{generalAsset.companyName} || '%')
		</if>
		<if
			test="generalAsset.approveState!= null and generalAsset.approveState != ''">
			AND APPROVE_STATE = #{generalAsset.approveState}
		</if>
		<if test="generalAsset.isDraft!= null and generalAsset.isDraft != ''">
			AND IS_DRAFT = #{generalAsset.isDraft}
		</if>
		<if
			test="generalAsset.isUpdateSap!= null and generalAsset.isUpdateSap != ''">
			AND IS_UPDATE_SAP = #{generalAsset.isUpdateSap}
		</if>
			<if
			test="generalAsset.assetClassification!= null and generalAsset.assetClassification != ''">
			AND ASSET_CLASSIFICATION LIKE '%' ||  #{generalAsset.assetClassification} || '%' 
		</if>
		and DELETED_FLAG='0' order by ID desc
		<include refid="count_Start_Tail" />
	</select>
	<select id="assetCodeCount" resultType="long"
		parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		select count(*) from TB_FA_GENERAL_ASSET WHERE
		1=1
		<if test="generalAsset.assetCode!= null and generalAsset.assetCode != ''">
			AND ASSET_CODE = #{generalAsset.assetCode}
		</if>
		<if
			test="generalAsset.companyCode!= null and generalAsset.companyCode != ''">
			AND COMPANY_CODE = #{generalAsset.companyCode}
		</if>
		AND DELETED_FLAG = '0'
	</select>

	<select id="searchGeneralAssetOnly" >
		select * from TB_FA_GENERAL_ASSET
		WHERE
		AND ASSET_CODE = #{generalAsset.assetCode}
		AND COMPANY_CODE = #{generalAsset.companyCode}
	    AND DELETED_FLAG = '0'
	</select>

	<insert id="insertGeneralAsset" parameterType="com.opple.fa.assetcard.entity.GeneralAsset"
		useGeneratedKeys="true" keyProperty="id">
		<selectKey keyProperty="id" order="BEFORE" resultType="long">
			select seq_general_asset.nextval as id from dual
		</selectKey>
		insert into TB_FA_GENERAL_ASSET
		( ID,
		CREATE_BY,
		CREATE_DATE,
		UPDATE_BY,
		UPDATE_DATE,
		ASSET_CODE,
		SYSTE_MANAGEMENT_CODE,
		ASSET_TYPE,
		ASSET_NAME,
		PUT_UNDER_MANAGE_CODE,
		IS_EXPENSE_ASSETS,
		ASSET_PERSON,
		SPECIFICATION_MODEL,
		PERSENT_DEPARTMENT,
		COMPANY_NAME,
		OFFICE_LOCATION,
		IS_DRAFT,
		USE_STATE,
		ASSET_STATE,
		APPROVE_STATE,
		ASSET_ORIGINAL_VALUE,
		ASSET_NET_VALUE,
		POSTING_DATE,
		PERSENT_STORAGE_LOCATION,
		DELETED_FLAG,
		ASSET_DETAIL_ID,
		OLD_ASSET_CODE,
		PURCHASE_ORDER_CODE,
		SUPPLIER_NAME,
		PERIOD_OF_DEPRECIATION,
		REAL_QUANTITY,
		COUNTED_QUANTITY,
		MANUFACTURER,
		USE_PEOPLE,
		USE_DEPARTMENT,
		LOCATION,
		REMARK,
		SERIAL_NUMBER,
		IS_UPDATE_SAP,
		PURCHASE_ID,
		CHECK_ACCEPT_ID,
		COST_CENTER_CODE,
		COMPANY_CODE,
		SUPPLIER_CODE,
		DIFFERENTIATE_PURCHASE,
		DATE_OF_ACCEPTANCE,
		WARRANTY_PERIOD,
		EXPIRATION_DATE,

		PLATFORM,
		SUPPLIER_LINKMAN,
		SUPPLIER_PHONE,
		DOCUMENT,
		DEMAND_ID,
		APPLY_ID,
		PURCHASE_ARRIVAL_DATE,
		ACTUAL_DATE_ACCEPTANCE,
		OLD_HOME_COMPANY,
		SELECT_ACCESSORIES,
		ASSET_CLASSIFICATION,
		MONTH_COUNTING_DEPRECIATION,
		CURRENT_YEAR_DEPRECIATION,
		SALVAGE_VALUE,
		DEPRECIATION_START_DATE,
		ACCEPTANCE_CYCLE,
		REMARK_ONE,
		REMARK_TWO,
		REMARK_THREE,
		ADD_DEPRECIATION,
		ASSET_PERSON_CODE,
		USE_DEPARTMENT_CODE,
		UNIT,
		UNIT_CODE,
		ASSET_CLASSIFICATION_NAME,
		IS_ALLOCATION_OCCUPANCY,
		IS_DISCARD_OCCUPANCY,
		IS_ASSEMBLE_OCCUPANCY
		)values
		(
		#{id},
		#{createBy},
		#{createDate},
		#{updateBy},
		#{updateDate},
		#{assetCode},
		#{systeManagementCode},
		#{assetType},
		#{assetName},
		#{putUnderManageCode},
		#{isExpenseAssets},
		#{assetPerson},
		#{specificationModel},
		#{persentDepartment},
		#{companyName},
		#{officeLocation},
		#{isDraft},
		#{useState},
		#{assetState},
		#{approveState},
		#{assetOriginalValue},
		#{assetNetValue},
		#{postingDate},
		#{persentStorageLocation},
		'0',
		#{assetDetailId},
		#{oldAssetCode},
		#{purchaseOrderCode},
		#{supplierName},
		#{periodOfDepreciation},
		#{realQuantity},
		#{countedQuantity},
		#{manufacturer},
		#{usePeople},
		#{useDepartment},
		#{location},
		#{remark},
		#{serialNumber},
		'0',
		#{purchaseId},
		#{checkAcceptId},
		#{costCenterCode},
		#{companyCode},
		#{supplierCode},
		#{differentiatePurchase},
		#{dateOfAcceptance},
		#{warrantyPeriod},
		#{expirationDate},

		#{platform},
		#{supplierLinkman},
		#{supplierPhone},
		#{document},
		#{demandId},
		#{applyId},
		#{purchaseArrivalDate},
		#{actualDateAcceptance},
		#{oldHomeCompany},
		#{selectAccessories},
		#{assetClassification},

		#{monthCountingDepreciation},
		#{currentYearDepreciation},
		#{salvageValue},
		#{depreciationStartDate},
		#{acceptanceCycle},
		#{remarkOne},
		#{remarkTwo},
		#{remarkThree},
		#{addDepreciation},
		#{assetPersonCode},
		#{useDepartmentCode},
		#{unit},
		#{unitCode},
		#{assetClassificationName},
		'0',
		'0',
		'0'
		)
	</insert>
	<update id="deleteAssetCard">
		update TB_FA_GENERAL_ASSET set DELETED_FLAG='1' where
		ID=#{id}
	</update>
	<update id="updateGeneralAsset" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">

		update TB_FA_GENERAL_ASSET
		<trim prefix="SET" suffixOverrides=",">
			<if test="null != specificationModel and specificationModel != '' ">
				SPECIFICATION_MODEL=#{specificationModel},
			</if>
			<if test="null != useState and useState != '' ">
				USE_STATE=#{useState},
			</if>
			<if test="null != oldAssetCode and oldAssetCode != '' ">
				OLD_ASSET_CODE=#{oldAssetCode},
			</if>
			<if test="null != supplierName and supplierName != '' ">
				SUPPLIER_NAME=#{supplierName},
			</if>
			<if test="null != supplierLinkman and supplierLinkman != '' ">
				SUPPLIER_LINKMAN=#{supplierLinkman},
			</if>
			<if test="null != supplierPhone and supplierPhone != '' ">
				SUPPLIER_PHONE=#{supplierPhone},
			</if>
			REMARK_ONE=#{remarkOne},
			REMARK_TWO=#{remarkTwo},
			REMARK_THREE=#{remarkThree},
			REMARK=#{remark}

			where ID=#{id}
		</trim>
	</update>

	<select id="searchGeneralAssetDetails" resultMap="generalAssetResultMap">
		<include refid="pagination_Head" />
		<include refid="search_general_asset_details" />
		<include refid="pagination_Tail" />
	</select>

	<select id="searchDetailsCount" resultType="long">
		<include refid="count_Start_Head" />
		<include refid="search_general_asset_details" />
		<include refid="count_Start_Tail" />
	</select>
	<select id="searchAssetBySapCode" parameterType="com.opple.fa.assetcard.entity.GeneralAsset"
		resultMap="generalAssetResultMap">
		select ASSET_CODE,
		SYSTE_MANAGEMENT_CODE,
		ASSET_TYPE,
		ASSET_NAME,
		PUT_UNDER_MANAGE_CODE,
		COMPANY_CODE,
		PERIOD_OF_DEPRECIATION,
		SUPPLIER_NAME,
		MANUFACTURER,
		IS_UPDATE_SAP from TB_FA_GENERAL_ASSET where DELETED_FLAG='0'
	</select>
	<update id="updateSapById">
		update TB_FA_GENERAL_ASSET set IS_UPDATE_SAP='1'
		where ID=#{id}
	</update>
	<sql id="search_general_asset_details">
		SELECT ID,
		CREATE_BY,
		CREATE_DATE,
		UPDATE_BY,
		UPDATE_DATE,
		ASSET_CODE,
		OLD_ASSET_CODE,
		PURCHASE_ORDER_CODE,
		SAP_ASSET_CODE,
		ASSET_TYPE,
		ASSET_NAME,
		PUT_UNDER_MANAGE_CODE,
		IS_EXPENSE_ASSETS,
		ASSET_PERSON,
		SPECIFICATION_MODEL,
		PERSENT_DEPARTMENT,
		COMPANY_NAME,
		OFFICE_LOCATION,
		IS_DRAFT,
		USE_STATE,
		ASSET_STATE,
		APPROVE_STATE,
		ASSET_ORIGINAL_VALUE,
		ASSET_NET_VALUE,
		POSTING_DATE,
		PERSENT_STORAGE_LOCATION,
		ASSET_DETAIL_ID,
		DELETED_FLAG,
		PERIOD_OF_DEPRECIATION,
		SUPPLIER_NAME,
		MANUFACTURER,
		USE_PEOPLE,
		USE_DEPARTMENT,
		LOCATION,
		REMARK,
		SERIAL_NUMBER,
		IS_UPDATE_SAP,
		PURCHASE_ID,
		CHECK_ACCEPT_ID,
		COST_CENTER_CODE,
		COMPANY_CODE,
		SUPPLIER_CODE,
		DOCUMENT,
		UNIT,
		ASSET_CLASSIFICATION_NAME,
		IS_ASSEMBLE_OCCUPANCY
		FROM TB_FA_GENERAL_ASSET
		WHERE
		1=1
		<if
			test="assetCheckBusiness.assetType != null and assetCheckBusiness.assetType != ''">
			AND ASSET_TYPE=#{assetCheckBusiness.assetType}
		</if>
		<if
			test="assetCheckBusiness.inventoryPeople != null and assetCheckBusiness.inventoryPeople != ''">
			AND ASSET_PERSON LIKE '%' || #{assetCheckBusiness.inventoryPeople} ||
			'%'
		</if>
		and DELETED_FLAG='0'
	</sql>

	<update id="updateCard" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">

		update TB_FA_GENERAL_ASSET set
		UPDATE_DATE=#{updateDate}
		<if test="null != platform and platform != '' ">
			,PLATFORM=#{platform}
		</if>
		<if test="null != assetPerson and assetPerson != '' ">
			,ASSET_PERSON=#{assetPerson}
		</if>
		<if test="null != assetPersonCode and assetPersonCode != '' ">
			,ASSET_PERSON_CODE=#{assetPersonCode}
		</if>
		<if test="null != persentDepartment and persentDepartment != '' ">
			,PERSENT_DEPARTMENT=#{persentDepartment}
		</if>
		<if test="null != costCenterCode and costCenterCode != ''">
			,COST_CENTER_CODE=#{costCenterCode}
		</if>
		<if test="null != companyName and companyName != '' ">
			,COMPANY_NAME=#{companyName}
		</if>
		<if test="null != companyCode and companyCode != '' ">
			,COMPANY_CODE=#{companyCode}
		</if>
		<if test="null != persentStorageLocation and persentStorageLocation != '' ">
			,PERSENT_STORAGE_LOCATION=#{persentStorageLocation}
		</if>
		<if test="null != useDepartment and useDepartment != '' ">

			,USE_DEPARTMENT=#{useDepartment}
		</if>
		<if test="null != officeLocation and officeLocation != '' ">
			,OFFICE_LOCATION=#{officeLocation}
		</if>
		<if test="null != assetCode and assetCode != '' ">
			,ASSET_CODE=#{assetCode}
		</if>
		<if test="null != oldAssetCode and oldAssetCode != '' ">
			,OLD_ASSET_CODE=#{oldAssetCode}
		</if>
		<if test="null != location and location != '' ">
			,LOCATION=#{location}
		</if>
		where ID=#{id}

	</update>
	<update id="updateCardStateById" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		update TB_FA_GENERAL_ASSET
		<trim prefix="SET" suffixOverrides=",">
			<if test="null != useState and useState != '' ">

				USE_STATE=#{useState},
			</if>
			UPDATE_DATE=#{updateDate}
		</trim>
		where ID=#{id}
	</update>

	<update id="updateGeneralAssetCard" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		update TB_FA_GENERAL_ASSET
		set
        LOCATION=#{location},
		ACTUAL_DATE_ACCEPTANCE=#{actualDateAcceptance}
		<if test="null != expirationDate and '' != expirationDate">
			,EXPIRATION_DATE=#{expirationDate}
		</if>
		<if test="null != unit and '' != unit">
			,UNIT = #{unit}
		</if>
		<if test="null != document and '' != document">
			,DOCUMENT = #{document}
		</if>
		<if test="null != assetDetailId and '' != assetDetailId">
			,ASSET_DETAIL_ID=#{assetDetailId}
		</if>
		<if test="null != checkAcceptId and '' != checkAcceptId">
			,CHECK_ACCEPT_ID=#{checkAcceptId}
		</if>
		<if test="null != specificationModel and '' != specificationModel">
			,SPECIFICATION_MODEL=#{specificationModel}
		</if>

		<if test="null != assetState and '' != assetState">
			,ASSET_STATE=#{assetState}
		</if>
		<if test="null != persentStorageLocation and '' != persentStorageLocation">
			,PERSENT_STORAGE_LOCATION=#{persentStorageLocation}
		</if>
		<if test="null != updateBy and '' != updateBy">
			,UPDATE_BY = #{updateBy}
		</if>
		<if test="null != updateDate and '' != updateDate">
			,UPDATE_DATE = #{updateDate}
		</if>
		<if test="null != postingDate and postingDate != '' ">

			,POSTING_DATE =#{postingDate}
		</if>

		where ID=#{id}
	</update>

	<update id="updateGeneralAssetCard_" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		update
		TB_FA_GENERAL_ASSET
		set
		EXPIRATION_DATE=#{expirationDate},
		ACTUAL_DATE_ACCEPTANCE=#{actualDateAcceptance},

		CHECK_ACCEPT_ID=#{checkAcceptId},
		SPECIFICATION_MODEL=#{specificationModel},


		PERSENT_STORAGE_LOCATION=#{persentStorageLocation},
		LOCATION=#{location},
		UPDATE_BY =	#{updateBy},
		UPDATE_DATE = #{updateDate}
		where ID=#{id}
	</update>

	<update id="updateAssetBySapCode" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		update
		TB_FA_GENERAL_ASSET
		set
		POSTING_DATE=#{postingDate},
		UPDATE_BY=#{updateBy},
		UPDATE_DATE=#{updateDate},
		ASSET_ORIGINAL_VALUE=#{assetOriginalValue},
		ASSET_NET_VALUE=#{assetNetValue},
		ASSET_CLASSIFICATION=#{assetClassification},
		ASSET_NAME=#{assetName},
		COST_CENTER_CODE=#{costCenterCode},
		MONTH_COUNTING_DEPRECIATION=#{monthCountingDepreciation},
		DEPRECIATION_START_DATE=#{depreciationStartDate},
		CURRENT_YEAR_DEPRECIATION=#{currentYearDepreciation},
		ACTUAL_DATE_ACCEPTANCE=#{actualDateAcceptance},
		PERIOD_OF_DEPRECIATION=#{periodOfDepreciation},
		ADD_DEPRECIATION=#{addDepreciation},
		SPECIFICATION_MODEL=#{specificationModel},
		PERSENT_DEPARTMENT=#{persentDepartment},
		COMPANY_NAME=#{companyName},
		ASSET_PERSON=#{assetPerson},
		ASSET_PERSON_CODE=#{assetPersonCode}
		
		where ID=#{id}
	</update>
	<update id="updateLeadingCard" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		update
		TB_FA_GENERAL_ASSET
		set

		CREATE_BY=#{createBy},
		CREATE_DATE=#{createDate},
		COMPANY_CODE=#{companyCode},
		ASSET_CODE=#{assetCode},
		ASSET_NAME=#{assetName},
		OLD_ASSET_CODE=#{oldAssetCode},
		OLD_HOME_COMPANY=#{oldHomeCompany},
		ASSET_TYPE=#{assetType},
		ASSET_CLASSIFICATION=#{assetClassification},
		IS_EXPENSE_ASSETS=#{isExpenseAssets},
		SPECIFICATION_MODEL=#{specificationModel},
		SELECT_ACCESSORIES=#{selectAccessories},
		ASSET_STATE=#{assetState},
		PURCHASE_ARRIVAL_DATE=#{purchaseArrivalDate},
		ACCEPTANCE_CYCLE=#{acceptanceCycle},
		DATE_OF_ACCEPTANCE=#{dateOfAcceptance},
		ACTUAL_DATE_ACCEPTANCE=#{actualDateAcceptance},
		WARRANTY_PERIOD=#{warrantyPeriod},
		EXPIRATION_DATE=#{expirationDate},
		POSTING_DATE=#{postingDate},
		COMPANY_NAME=#{companyName},
		PLATFORM=#{platform},
		PERSENT_DEPARTMENT=#{persentDepartment},
		USE_DEPARTMENT=#{useDepartment},
		ASSET_PERSON=#{assetPerson},
		OFFICE_LOCATION=#{officeLocation},
		LOCATION=#{location},
		USE_STATE=#{useState},
		REMARK_ONE=#{remarkOne},
		REMARK_TWO=#{remarkTwo},
		REMARK_THREE=#{remarkThree},
		REMARK=#{remark},
		ASSET_ORIGINAL_VALUE=#{assetOriginalValue},
		ASSET_NET_VALUE=#{assetNetValue},
		PERIOD_OF_DEPRECIATION=#{periodOfDepreciation},
		DEPRECIATION_START_DATE=#{depreciationStartDate},
		MONTH_COUNTING_DEPRECIATION=#{monthCountingDepreciation},
		CURRENT_YEAR_DEPRECIATION=#{currentYearDepreciation},
		ADD_DEPRECIATION=#{addDepreciation},
		SALVAGE_VALUE=#{salvageValue},
		SUPPLIER_NAME=#{supplierName},
		SUPPLIER_CODE=#{supplierCode},
		SUPPLIER_LINKMAN=#{supplierLinkman},
		SUPPLIER_PHONE=#{supplierPhone},
		COST_CENTER_CODE=#{costCenterCode}
		where ASSET_CODE=#{assetCode} and COMPANY_CODE=#{companyCode}
	</update>
	<update id="updateAssetState" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		update TB_FA_GENERAL_ASSET
		set
		USE_STATE=#{useState}
		where ID=#{id}
	</update>
	<!-- 审批最后一步同意后，将资产状态改为已验收 -->
	<update id="updatePostingDate" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		update
		TB_FA_GENERAL_ASSET
		set
		POSTING_DATE = sysdate,
		ASSET_STATE = '1',
		USE_STATE = '0'
		where id=#{id}
	</update>
	<update id="deleteAssetCardReal">
		update TB_FA_GENERAL_ASSET
		set deleted_flag = '1'
		where id = #{id}
	</update>

	<update id="updateGeneralAssetCard2" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		UPDATE
		TB_FA_GENERAL_ASSET
		set
		EXPIRATION_DATE = #{expirationDate},
		ACTUAL_DATE_ACCEPTANCE = #{actualDateAcceptance},
		DOCUMENT
		=#{document},
		CHECK_ACCEPT_ID = #{checkAcceptId},
		USE_STATE =
		#{useState},
		PERSENT_STORAGE_LOCATION = #{persentStorageLocation},
		UNIT=#{unit}

		where id=#{id}
	</update>
	<update id="updateAllocationOccupancy" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		UPDATE
		TB_FA_GENERAL_ASSET
		set IS_ALLOCATION_OCCUPANCY=#{isAllocationOccupancy}
		where ID=#{id}
	</update>
	<update id="updateDiscardOccupancy" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		UPDATE
		TB_FA_GENERAL_ASSET
		set IS_DISCARD_OCCUPANCY=#{isDiscardOccupancy},
		USE_STATE=#{useState}
		where ID=#{id}
	</update>
	<select id="serachByacctingUpdateSap" resultMap="generalAssetResultMap" >
		select * from
		TB_FA_GENERAL_ASSET where IS_EXPENSE_ASSETS='0' and ASSET_STATE='1'
		and DELETED_FLAG='0'
		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND ASSET_TYPE=#{generalAsset.assetType}

		</if>
	</select>
	
	
	<sql id="serchAssetCardDataWhere">
		AND tb_fa_general_asset_.DELETED_FLAG = '0'
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS
			=#{generalAsset.isExpenseAssets}
		</if>
		<if test="generalAsset.assetState != null and generalAsset.assetState!=''">
			AND tb_fa_general_asset_.ASSET_STATE =#{generalAsset.assetState}
		</if>
		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND tb_fa_general_asset_.ASSET_TYPE=#{generalAsset.assetType}

		</if>
		<if
			test="generalAsset.systeManagementCode != null and generalAsset.systeManagementCode != ''">
			AND tb_fa_general_asset_.SYSTE_MANAGEMENT_CODE LIKE '%' ||
			#{generalAsset.systeManagementCode} || '%'

		</if>
		<if test="generalAsset.assetCode != null and generalAsset.assetCode != ''">
			AND tb_fa_general_asset_.ASSET_CODE LIKE '%' || #{generalAsset.assetCode} || '%'
		</if>
		<if
			test="generalAsset.putUnderManageCode != null and generalAsset.putUnderManageCode != ''">
			AND tb_fa_general_asset_.PUT_UNDER_MANAGE_CODE LIKE '%' || #{generalAsset.putUnderManageCode}
			|| '%'
		</if>
		<if test="generalAsset.assetName != null and generalAsset.assetName != ''">
			AND tb_fa_general_asset_.ASSET_NAME LIKE '%' || #{generalAsset.assetName} || '%'
		</if>
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS =#{generalAsset.isExpenseAssets}
		</if>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson != ''">
			AND tb_fa_general_asset_.ASSET_PERSON LIKE '%' || #{generalAsset.assetPerson} || '%'
		</if>
		<if
			test="generalAsset.specificationModel != null and generalAsset.specificationModel != ''">
			AND tb_fa_general_asset_.SPECIFICATION_MODEL LIKE '%' || #{generalAsset.specificationModel}
			|| '%'
		</if>
		<if
			test="generalAsset.persentDepartment != null and generalAsset.persentDepartment != ''">
			AND tb_fa_general_asset_.PERSENT_DEPARTMENT LIKE '%' || #{generalAsset.persentDepartment} ||
			'%'
		</if>
		<if
			test="generalAsset.officeLocation != null and generalAsset.officeLocation != ''">
			AND tb_fa_general_asset_.OFFICE_LOCATION LIKE '%' || #{generalAsset.officeLocation} || '%'
		</if>
	AND (
		tb_fa_general_asset_.ASSET_PERSON_CODE = #{generalAsset.loginUseCode} 
         or (tb_fa_general_asset_.COST_CENTER_CODE in ( select b.ccostcentercode
		  from t_sys_datapermission a
		 inner join tb_fa_depcostcenter b
		    on a.cbudgetdepcode = b.cdepcode
		 where a.cusercode=#{generalAsset.loginUseCode}))
		
		OR
		tb_fa_general_asset_.ASSET_PERSON_CODE IN (SELECT CAUTHORIZERCODE FROM
		T_APPROVALEMPOWER WHERE CUSERCODE = #{generalAsset.loginUseCode})
		or (tb_fa_general_asset_.Cost_Center_Code, tb_fa_general_asset_.Company_Code, tb_fa_general_asset_.ASSET_TYPE) in
				       (SELECT C.COSTCENTER_CODE,
		               C.COMPANY_CODE,
		               CASE
		                 WHEN C.ASSET_TYPE = 'IT资产' THEN
		                  '0'
		                 WHEN C.ASSET_TYPE = '行政资产' THEN
		                  '1'
		                 WHEN C.ASSET_TYPE = '计量器具' THEN
		                  '2'
		                 WHEN C.ASSET_TYPE = '机器设备' THEN
		                  '3'
		               END ASSET_TYPE
		          FROM TB_FA_ATTACH_CONFIG C
		         WHERE C.ATTACH_DEPART_ADMIN_CODE = #{generalAsset.loginUseCode})
		
		       

		)
	</sql>
	
	<select id="serchAssetCardDataIT" resultMap="generalAssetResultMap">
		SELECT DISTINCT tb_fa_general_asset_.*,
                TA.Serial_Number serialNumberDetailIT,
                ta.put_under_manage_code putUnderManageCodeIT,
                ta.cpu cpuIT,
                ta.internal_memory internalMemoryIT,
                ta.hardpan hardpanIT,
                ta.ip_address ipAddressIT,
                ta.join_domain joinDomainIT,
                ta.join_domain operatingSystemIT,
                ta.utility_system utilitySystemIT,
                ta.description descriptionIT,
                ta.data_base dataBaseIT
			FROM TB_FA_GENERAL_ASSET
			tb_fa_general_asset_
			LEFT JOIN T_SAP_COSTCENTER TC
			ON tb_fa_general_asset_.COST_CENTER_CODE = TC.CCOSTCENTERCODE
		 	LEFT JOIN Tb_Fa_Computer_Asset TA
    		ON TA.ID = TB_FA_GENERAL_ASSET_.ASSET_DETAIL_ID
			where 1=1
			
		<include refid="serchAssetCardDataWhere"></include>
	</select>
	<select id="serchAssetCardDataXZ" resultMap="generalAssetResultMap">
		SELECT DISTINCT tb_fa_general_asset_.*,
                TA.SERIAL_NUMBER serialNumberXZ,
                TA.MANAGEMENT_CODE managementCodeXZ,
                TA.IS_BUILDING_CONTRUCTION isBuildingContructionXZ
			FROM TB_FA_GENERAL_ASSET
			tb_fa_general_asset_
			LEFT JOIN T_SAP_COSTCENTER TC
			ON tb_fa_general_asset_.COST_CENTER_CODE = TC.CCOSTCENTERCODE
		 	LEFT JOIN TB_FA_ADMINISTRATION_ASSET TA
    		ON TA.ID = TB_FA_GENERAL_ASSET_.ASSET_DETAIL_ID
			where 1=1
			
		<include refid="serchAssetCardDataWhere"></include>
	</select>
	<select id="serchAssetCardDataJL" resultMap="generalAssetResultMap">
		SELECT DISTINCT tb_fa_general_asset_.*,
                TA.FACROTY_NUMBER facrotyNumberJL,
                TA.MANAGEMENT_CODE managementCodeJL,
                TA.MANUFACTURE_FACTORY manufactureFactoryJL,
                TA.MANAGEMENT_LEVEL managementLevelJL,
                TA.ACCURACY_CLASS accuracyClassJL,
                TA.VERIFICATION_CYCLE verificationCycleJL,
                TA.CALIBRATION_DATE calibrationDateJL,
                TA.NEXT_CALIBRATION_DATE nextCalibrationDateJL,
                TA.CALIBRATION_UNIT calibrationUnitJL,
                TA.IS_THIRD_REPORT isThirdReportJL
			FROM TB_FA_GENERAL_ASSET
			tb_fa_general_asset_
			LEFT JOIN T_SAP_COSTCENTER TC
			ON tb_fa_general_asset_.COST_CENTER_CODE = TC.CCOSTCENTERCODE
		 	LEFT JOIN Tb_Fa_Measuring_Instruments TA
    		ON TA.ID = TB_FA_GENERAL_ASSET_.ASSET_DETAIL_ID
			where 1=1
			
		<include refid="serchAssetCardDataWhere"></include>
	</select>
	<select id="serchAssetCardDataJX" resultMap="generalAssetResultMap">
		SELECT DISTINCT tb_fa_general_asset_.*,
                TA.MACHINE_CODE machineCodeJX,
                TA.PUT_UNDER_MANAGE_CODE putUnderManageCodeJX,
                TA.SHOP_TYPE shopTypeJX
			FROM TB_FA_GENERAL_ASSET
			tb_fa_general_asset_
			LEFT JOIN T_SAP_COSTCENTER TC
			ON tb_fa_general_asset_.COST_CENTER_CODE = TC.CCOSTCENTERCODE
		 	LEFT JOIN Tb_Fa_Machinery_Equipment TA
    		ON TA.ID = TB_FA_GENERAL_ASSET_.ASSET_DETAIL_ID
			where 1=1
			
		<include refid="serchAssetCardDataWhere"></include>
	</select>
	
	<sql id="serchAssetCardDateByAccountingWhere">
		tb_fa_general_asset_.DELETED_FLAG = '0'
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS
			=#{generalAsset.isExpenseAssets}
		</if>
		<if test="generalAsset.assetState != null and generalAsset.assetState!=''">
			AND tb_fa_general_asset_.ASSET_STATE =#{generalAsset.assetState}
		</if>
		<if test="generalAsset.assetType != null and generalAsset.assetType != ''">
			AND tb_fa_general_asset_.ASSET_TYPE=#{generalAsset.assetType}

		</if>
		<if
			test="generalAsset.systeManagementCode != null and generalAsset.systeManagementCode != ''">
			AND tb_fa_general_asset_.SYSTE_MANAGEMENT_CODE LIKE '%' ||
			#{generalAsset.systeManagementCode} || '%'

		</if>
		<if test="generalAsset.assetCode != null and generalAsset.assetCode != ''">
			AND tb_fa_general_asset_.ASSET_CODE LIKE '%' || #{generalAsset.assetCode} || '%'
		</if>
		<if
			test="generalAsset.putUnderManageCode != null and generalAsset.putUnderManageCode != ''">
			AND tb_fa_general_asset_.PUT_UNDER_MANAGE_CODE LIKE '%' || #{generalAsset.putUnderManageCode}
			|| '%'
		</if>
		<if test="generalAsset.assetName != null and generalAsset.assetName != ''">
			AND tb_fa_general_asset_.ASSET_NAME LIKE '%' || #{generalAsset.assetName} || '%'
		</if>
		<if
			test="generalAsset.isExpenseAssets != null and generalAsset.isExpenseAssets!= ''">
			AND tb_fa_general_asset_.IS_EXPENSE_ASSETS =#{generalAsset.isExpenseAssets}
		</if>
		<if
			test="generalAsset.assetPerson != null and generalAsset.assetPerson != ''">
			AND tb_fa_general_asset_.ASSET_PERSON LIKE '%' || #{generalAsset.assetPerson} || '%'
		</if>
		<if
			test="generalAsset.specificationModel != null and generalAsset.specificationModel != ''">
			AND tb_fa_general_asset_.SPECIFICATION_MODEL LIKE '%' || #{generalAsset.specificationModel}
			|| '%'
		</if>
		<if
			test="generalAsset.persentDepartment != null and generalAsset.persentDepartment != ''">
			AND tb_fa_general_asset_.PERSENT_DEPARTMENT LIKE '%' || #{generalAsset.persentDepartment} ||
			'%'
		</if>
	</sql>
	<select id="serchAssetCardDateByAccountingIT" resultMap="generalAssetResultMap">
		SELECT tb_fa_general_asset_.*,
                TA.Serial_Number serialNumberDetailIT,
                ta.put_under_manage_code putUnderManageCodeIT,
                ta.cpu cpuIT,
                ta.internal_memory internalMemoryIT,
                ta.hardpan hardpanIT,
                ta.ip_address ipAddressIT,
                ta.join_domain joinDomainIT,
                ta.join_domain operatingSystemIT,
                ta.utility_system utilitySystemIT,
                ta.description descriptionIT,
                ta.data_base dataBaseIT
		FROM TB_FA_GENERAL_ASSET tb_fa_general_asset_ 
		LEFT JOIN Tb_Fa_Computer_Asset TA
    		ON TA.ID = TB_FA_GENERAL_ASSET_.ASSET_DETAIL_ID
		where 1=1 AND
		<include refid="serchAssetCardDateByAccountingWhere"></include>
	</select>
	<select id="serchAssetCardDateByAccountingXZ" resultMap="generalAssetResultMap">
		SELECT tb_fa_general_asset_.*,
                TA.SERIAL_NUMBER serialNumberXZ,
                TA.MANAGEMENT_CODE managementCodeXZ,
                TA.IS_BUILDING_CONTRUCTION isBuildingContructionXZ
		FROM TB_FA_GENERAL_ASSET tb_fa_general_asset_ 
		LEFT JOIN TB_FA_ADMINISTRATION_ASSET TA
    		ON TA.ID = TB_FA_GENERAL_ASSET_.ASSET_DETAIL_ID
		where 1=1 AND
		<include refid="serchAssetCardDateByAccountingWhere"></include>
	</select>
	<select id="serchAssetCardDateByAccountingJL" resultMap="generalAssetResultMap">
		SELECT tb_fa_general_asset_.*,
                TA.FACROTY_NUMBER facrotyNumberJL,
                TA.MANAGEMENT_CODE managementCodeJL,
                TA.MANUFACTURE_FACTORY manufactureFactoryJL,
                TA.MANAGEMENT_LEVEL managementLevelJL,
                TA.ACCURACY_CLASS accuracyClassJL,
                TA.VERIFICATION_CYCLE verificationCycleJL,
                TA.CALIBRATION_DATE calibrationDateJL,
                TA.NEXT_CALIBRATION_DATE nextCalibrationDateJL,
                TA.CALIBRATION_UNIT calibrationUnitJL,
                TA.IS_THIRD_REPORT isThirdReportJL
		FROM TB_FA_GENERAL_ASSET tb_fa_general_asset_ 
		LEFT JOIN Tb_Fa_Measuring_Instruments TA
    		ON TA.ID = TB_FA_GENERAL_ASSET_.ASSET_DETAIL_ID
		where 1=1 AND
		<include refid="serchAssetCardDateByAccountingWhere"></include>
	</select>
	<select id="serchAssetCardDateByAccountingJX" resultMap="generalAssetResultMap">
		SELECT tb_fa_general_asset_.*,
                TA.MACHINE_CODE machineCodeJX,
                TA.PUT_UNDER_MANAGE_CODE putUnderManageCodeJX,
                TA.SHOP_TYPE shopTypeJX
		FROM TB_FA_GENERAL_ASSET tb_fa_general_asset_ 
		LEFT JOIN Tb_Fa_Machinery_Equipment TA
    		ON TA.ID = TB_FA_GENERAL_ASSET_.ASSET_DETAIL_ID
		where 1=1 AND
		<include refid="serchAssetCardDateByAccountingWhere"></include>
	</select>
	
	<update id="updateAssembleOccupancy" parameterType="com.opple.fa.assetcard.entity.GeneralAsset">
		update TB_FA_GENERAL_ASSET set IS_ASSEMBLE_OCCUPANCY=#{isAssembleOccupancy} where ID=#{id}
	</update>
	<update id="updateAssetFromSapByList">
		   <foreach collection="list" item="item" index="index" open="begin" close=";end;" separator=";">
            UPDATE TB_FA_GENERAL_ASSET set
	            POSTING_DATE=#{item.postingDate},
				UPDATE_BY=#{item.updateBy},
				UPDATE_DATE=#{item.updateDate},
				ASSET_ORIGINAL_VALUE=#{item.assetOriginalValue},
				ASSET_NET_VALUE=#{item.assetNetValue},
				ASSET_CLASSIFICATION=#{item.assetClassification},
				ASSET_NAME=#{item.assetName},
				COST_CENTER_CODE=#{item.costCenterCode},
				MONTH_COUNTING_DEPRECIATION=#{item.monthCountingDepreciation},
				DEPRECIATION_START_DATE=#{item.depreciationStartDate},
				CURRENT_YEAR_DEPRECIATION=#{item.currentYearDepreciation},
				ACTUAL_DATE_ACCEPTANCE=#{item.actualDateAcceptance},
				PERIOD_OF_DEPRECIATION=#{item.periodOfDepreciation},
				ADD_DEPRECIATION=#{item.addDepreciation},
				SPECIFICATION_MODEL=#{item.specificationModel},
				PERSENT_DEPARTMENT=#{item.persentDepartment},
				COMPANY_NAME=#{item.companyName},
				ASSET_PERSON=#{item.assetPerson},
				ASSET_PERSON_CODE=#{item.assetPersonCode}
            	WHERE ID = #{item.id}
        </foreach>
	</update>
</mapper>

