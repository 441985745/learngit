<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.opple.fa.config.dao.SupplierDAO">
       <!-- oracle 分页头 -->
    <sql id="pagination_Head" >
        <![CDATA[select * from ( select row_.*, rownum rownum_ from ( ]]>
    </sql>
    <!-- oracle 分页尾 -->
    <sql id="pagination_Tail">
        <![CDATA[) row_ where rownum <= #{pager.pageSize}* #{pager.offset} ) where rownum_ >= #{pager.firstResult} + 1]]>
    </sql>
    <!-- count * from -->
	<sql id="count_Start_Head">
		<![CDATA[select count(*) from ( ]]>
	</sql>
	<sql id="count_Start_Tail">
		<![CDATA[) countObj ]]>
	</sql>
	<resultMap id="supplierResultMap" type="com.opple.fa.config.entity.Supplier">
        <result property="supplierName" column="CSUPPLIERNAME"/>
        <result property="supplierCode" column="CSUPPLIERCODE"/>
        <result property="paymentTypeName" column="CPAYMENTTYPENAME"/>
        <result property="paymentTypeCode" column="CPAYMENTTYPECODE"/>
        <result property="bankName" column="CBANKNAME"/>
        <result property="bankCode" column="CBANKCODE"/>
        <result property="bankNumber" column="CACCOUNT"/>
        <!-- <result property="contactNumber" column=""/> 联行号 -->
        <result property="contacts" column="CLINKMAN"/>
        <result property="telephone" column="CHANDPHONE"/>
        <result property="companyAddress" column="CADDRESS"/>
        <result property="currencyCode" column="CCURRENCYCODE"/>
        <result property="currencyName" column="CCURRENCYNAME"/>
        <!-- <result property="companySpecificName" column=""/>公司具体名称 -->
        <result property="country" column="COUNTRY"/>
        <!-- <result property="city" column=""/>
        <result property="zipCode" column=""/> -->
        
	</resultMap>

    <select id="searchSupplier" resultMap="supplierResultMap">
     <![CDATA[
		SELECT T.CSUPPLIERCODE,
			T.CSUPPLIERNAME,
			T.COUNTRY,
			T.CPAYMENTTYPECODE,
			T.CPAYMENTTYPENAME,
			TA.CBANKCODE,
			TA.CBANKNAME,
			TA.CACCOUNT,
			T.CLINKMAN,
			T.CHANDPHONE,
			T.CADDRESS,
	        TA.CCURRENCYCODE,  
	        TA.CCURRENCYNAME    
		FROM T_SUPPLIER T, T_SUPPLIERACCOUNT TA, T_COMPANYSUPPLIER TC  
        
         WHERE T.CSUPPLIERCODE = TA.CSUPPLIERCODE  
         AND T.CSUPPLIERCODE = TC.CSUPPLIERCODE   
         AND T.CSUPPLIERGROUPCODE <> 'Z060'   
         AND ta.cpo_code='1001'
         ]]> 
		<if
			test="companyCode != null and companyCode != ''">
			AND TC.CCOMPANYCODE = #{companyCode}    
		</if>
		<if
			test="supplierName != null and supplierName != ''">
			AND T.CSUPPLIERNAME LIKE '%' || #{supplierName} || '%' 
		</if>
		<if
			test="supplierCode != null and supplierCode != ''">
			AND T.CSUPPLIERCODE LIKE '%' || #{supplierCode} || '%' 
		</if>
    </select>
	<select id="searchSupplierByCodeAndName" resultMap="supplierResultMap">
     <![CDATA[
		SELECT *
		FROM T_SUPPLIER T, T_SUPPLIERACCOUNT TA, T_COMPANYSUPPLIER TC  
        
         WHERE T.CSUPPLIERCODE = TA.CSUPPLIERCODE  
         AND T.CSUPPLIERCODE = TC.CSUPPLIERCODE   
         AND T.CSUPPLIERGROUPCODE <> 'Z060'   
         ]]> 
		
			AND T.CSUPPLIERNAME = #{supplierName} 
			AND T.CSUPPLIERCODE = #{supplierCode}
    </select>
</mapper>

